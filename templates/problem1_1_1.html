<!doctype html>
<html>
    <head>
      <!--Stylesheet for all pages-->
      <link rel="stylesheet" href="/static/css/style.css">
      <meta charset="UTF-8">
      <title>Unit 1-Concept 1: First Derivatives</title>
      <!--KaTex Formatting-->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
      <!--MathJax Formatting-->
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      <!-- Confetti! -->
      <script src="confetti.js"></script>
      <style>
        body {
          background-image: url("/static/images/concept1_1_1.jpg");
          background-size: cover;
        }
      </style>
    </head>

    <body>
      <header>
        <nav class="navbar">
                <ul id="dashboard-navbar">
                    <li><a href="/dashboard">Dashboard</a></li>
                    <li><a href="/unit1">Unit 1</a></li>
                    <li><a href="/character_profile">Character Profile</a></li>
                    <li><a href="/student_profile">Student Profile</a></li>
                    <!-- <li><a href="/concept1_1">Unit 1-Concept 1</a></li> -->
                </ul>
        </nav>
      </header>
      <aside class="sidebar">
        <ul>
            <li>
                <a href="/concept1_1">Unit 1: Concept 1</a>
                <ul>
                    <li><a href="/problem1_1_1">Problem 1</a></li>
                    <li><a href="/problem1_1_2">Problem 2</a></li>
                    <li><a href="/problem1_1_3">Problem 3</a></li>
                </ul>
            </li>
            <li>
                <a href="/concept1_2">Unit 1: Concept 2</a>
                <ul>
                    <li><a href="unit1_concept2_problem1.html">Problem 1</a></li>
                    <li><a href="unit1_concept2_problem2.html">Problem 2</a></li>
                    <li><a href="unit1_concept2_problem3.html">Problem 3</a></li>
                </ul>
            </li>
            <li>
                <a href="unit1_concept3.html">Unit 1: Concept 3</a>
                <ul>
                    <li><a href="unit1_concept3_problem1.html">Problem 1</a></li>
                    <li><a href="unit1_concept3_problem2.html">Problem 2</a></li>
                    <li><a href="unit1_concept3_problem3.html">Problem 3</a></li>
                </ul>
            </li>
        </ul>
    </aside>

    <!-- <div class="container"> -->
      <div class="middle-column">

        <h1>Unit 1 - Concept 1: First Derivatives</h1>

        <h2>Solve for the derivative of the following function, with respect to x:</h2>
      

        <div id="derivative">$$f(x)= {{f}}$$</div>
        <form>
          <label style="display: inline-block; font-size: 30px;" for="equationInput">$$df/dx = $$</label>
          <input type="text" style="width: 300px; height: 50px; font-size: 30px;" id="equationInput" name="equationInput">
          <button type="button" onclick="checkAnswer()">Submit Answer</button>
        </form>


        <label for="outputDiv"style="font-size: 30px;">Formatted Answer:</label>
        <div id="outputDiv"style="font-size: 30px;"></div>

        <p id="result"style="font-size: 50px;"></p>

        <!-- <div>CORRECT Answer: {{df_dx}}</div> -->

        <!-- Create point and problem completion counters on the side: -->
        <div class="point-bubble">
          <label for="points">Planet Points</label>
          <span id="points" class="counter">{{ problem_points }}</span>
        </div>

        <div class="problem-bubble">
          <label for="problem-progress">Concept Completion</label>
          <span id="problem-progress" class="counter">{{ problem_points }}</span>
        </div>
      
        <!-- Apply Formatting to equation-->
        <script>
          const inputField = document.getElementById('equationInput');
          const outputDiv = document.getElementById('outputDiv');
      
          inputField.addEventListener('input', () => {
            const inputText = inputField.value;
            outputDiv.textContent = inputText;
            katex.render(inputText, outputDiv);
          });
        </script>

        <!-- Restart Problem -->
        <div>
          <button id="answer" type="button">Submit Answer</button>
          <button id="regenerate" type="submit" onclick="restart()">Next Problem</button>
          <script>
            function restart() {
              window.location.reload();
            }
          </script>
        </div>

        <div id="messageContainer"></div>
        
        <!-- Submit and Check Answer Javascript -->
        <script>
          function checkAnswer() {
            const userInput = document.getElementById("equationInput").value;
            const df_dx = "{{ df_dx }}"; 
            const resultElement = document.getElementById("result");
            
            if (userInput === df_dx) {
              resultElement.innerText = "Congratulations! Your answer is correct.";
              startConfetti();
              confetti.maxCount = 20;
              addPoints();
            } else {
              resultElement.innerText = "Not yet. Please try again!";
            }
          }
        </script>

                <!-- Update point and problem counters -->
        <script>
          function addPoints() {
            let planet_points = parseInt("{{ planet_points }}");
            let problem_points = parseInt("{{ problem_points }}");

            planet_points += 5;
            problem_points += 1;

            fetch('/planet_points', {
              method: 'POST',
              body: JSON.stringify({planet_points: planet_points, problem_points: problem_points}), 
              headers:{
                'Content-Type': 'application/json'
              }
            }).then(response => {
              document.getElementById('planet_points').innerText = planet_points;
              document.getElementById('problem_points').innerText = problem_points;
            }).catch(error => console.error(error));

          }

        </script>


        <!-- Update point and problem counters -->
        <script>
    
        </script>
      </div>  
    <!-- </div>    -->
    </body>
  </html>
